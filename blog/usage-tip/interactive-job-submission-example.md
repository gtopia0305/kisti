# 인터렉티브 작업 제출 예제

KISTI 슈퍼컴퓨터 시스템에서는 기본적으로 스케줄러를 이용하여 작업을 제출하고 계산을 수행하도록 되어 있지만, 코드 개발이나 컴파일, 디버깅을 위해 자원을 할당받아 인터렉티브 모드로 작업을 수행할 수도 있다. 누리온과 뉴론은 각각 다른 스케줄러를 사용하고 있기 때문에 계산 자원을 할당받아 사용하는 명령은 다르다.&#x20;

&#x20;

&#x20;※ 2020년 6월 PM 이후, 2시간 이상 미사용시 타임아웃으로 작업이 종료되고 할당 받은 자원이 회수되며 인터렉티브 작업의 walltime은 최대 12시간으로 고정된다.

&#x20;※ 인터렉티브 작업을 포함한 모든 작업 제출은 scratch 디렉토리에서 제출되어야 한다.

&#x20;

&#x20;

■ 누리온 인터렉티브 작업 제출

&#x20;

○ 인터렉티브 작업 제출

| $ qsub **-I** -l select=1:ncpus=64:ompthreads=1 -l walltime=02:00:00 -q {큐 이름} -A {PBS 옵션 이름} |
| --------------------------------------------------------------------------------------------- |

&#x20;

○ 인터렉티브 작업 제출 시 그래픽 환경 사용 (-X)

| $ qsub -I **-X** -l select=1:ncpus=64:ompthreads=1 -l walltime=02:00:00 -q {큐 이름} -A {PBS 옵션 이름} |
| ------------------------------------------------------------------------------------------------ |

&#x20;

○ 인터렉티브 작업 제출 시 기존 환경변수 상속 (-V)

| $ qsub -I **-V** -l select=1:ncpus=64:ompthreads=1 -l walltime=02:00:00 -q {큐 이름} -A {PBS 옵션 이름} |
| ------------------------------------------------------------------------------------------------ |

&#x20;※ Application별 PBS 옵션 이름은 누리온 사용자 지침서를 참고하길 바람

&#x20;   (누리온 사용자 지침서 : [www.ksc.re.kr/gsjw/jcs/hd](https://www.ksc.re.kr/gsjw/jcs/hd))

&#x20;

&#x20;

■ 뉴론 인터렉티브 작업 제출

&#x20;

○ 인터렉티브 작업 제출

(1) 자원 할당

\* 설명 : ivy\_v100\_2 파티션의 gpu 2노드(각각 2core, 2gpu)를 interactive 용도로 사용

| <p> $ salloc --partition=ivy_v100_2 -N 2 -n 4 --tasks-per-node=2 --gres=gpu:2 --comment={SBATCH 옵션이름} <br></p> |
| -------------------------------------------------------------------------------------------------------------- |

※ Application별 SBATCH 옵션 이름표 참고

**※ 2시간 이상 미사용시 타임아웃으로 작업이 종료되고 자원이 회수됨, 인터렉티브 작업의 walltime은 최대 12시간으로 고정됨**

&#x20;

(2) 작업 실행

| <p> $ srun ./(실행파일) (실행옵션) <br></p> |
| ----------------------------------- |

&#x20;

(3) 헤드 노드 접속

| <p> $ srun --pty bash <br></p> |
| ------------------------------ |

**※ 2시간 이상 키보드 미입력시 타임아웃으로 작업이 종료되고 자원이 회수됨**\
**※ 헤드 노드에 접속한 후에는 srun을 통한 작업 제출 불가능**

&#x20;

(4) 진입한 노드에서 나가기 또는 자원 할당 취소

|  $ exit |
| ------- |

&#x20;

(5) 커맨드를 통한 작업 삭제

|  $ scancel \[Job\_ID] |
| --------------------- |

**※ Job ID는 squeue 명령으로 확인 가능**

&#x20;

&#x20;

■ 인터렉티브 작업 예제

| <p> $ qsub -I -l select=1:ncpus=64:ompthreads=1 -l walltime=02:00:00 -q normal -A etc<br>qsub: waiting for job 5465046.pbs to start<br>qsub: job 5465046.pbs ready<br><br>[support@node4091 job_examples]$ module purge<br>[support@node4091 job_examples]$ module load craype-mic-knl intel/18.0.3 impi/18.0.3<br>[support@node4091 job_examples]$ mpiicc -o test_mpi.exe -O3 -fPIC -xCOMMON-AVX512 test_mpi.c<br>[support@node4091 job_examples]$ mpirun -np 4 ./test_mpi.exe<br><br>Hello World from Node 0<br>Hello World from Node 1<br>Hello World from Node 2<br>Hello World from Node 3</p> |
| --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |

&#x20;※ 뉴론의 경우, 작업 제출 방법과 module 이름이 다르니 자세한 내용은 뉴론 사용자 지침서 참고 바람

&#x20;   (뉴론 인터렉티브 작업제출 동영상 가이드 : [blog.ksc.re.kr/189](https://blog.ksc.re.kr/189))

\
