---
description: 슈퍼컴퓨팅인프라센터 2019. 5. 28. 10:47
---

# 누리온 WRFV3.9.1.1 설치

KISTI 슈퍼컴퓨팅센터의 누리온 시스템에 WRFV3.9.1.1 Source 버전과 WPSV3.9.1 Source 버전을 설치 하는 방법에 대하여 소개한다.



**1. 설치 환경**

|  **구분**     | **내용**                      |
| ----------- | --------------------------- |
|  대상 시스템     |  누리온                        |
| OS Version  |  리눅스 / CentOS 7.3           |
|  CPU        |  Intel(R) Xeon(R) Gold 6126 |
|  컴파일러       |  Intel 2018.3 Version       |
|  MPI        |  IntelMPI 2018.3 Version    |
|  기타         |                             |



**2. 설치 전 환경 설정**

&#x20; 누리온 시스템은 PATH, LD\_LIBRARY\_PATH 등을 쉽게 하기 위하여 \
&#x20; 환경설정 툴인 Modules(http://modules.sourceforge.net)이 구성되어 있고,\
&#x20; 이하 설치 소개 에서는 module load를 이용한 환경 설정 방법을 이용한다.



\[ 환경 설정 ]

| <p> $ module load craype-mic-knl intel/18.0.3 impi/18.0.3</p><p> $ module load hdf4/4.2.13 hdf5/1.10.2 netcdf/4.6.1 ncl/6.5.0</p><p> $ export JASPERLIB=/apps/common/jasper/1.900.29/lib</p><p> $ export JASPERINC=/apps/common/jasper/1.900.29/include</p> |
| ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |



**3. WRF 설치 과정**

&#x20;설치 과정 소개는 tar 를 이용한 압축 해제 방법과 설정 방법등 진행 절차를 위주로 설명하고, 소스 파일 다운로드 등은 생략한다. &#x20;

|  **설치 과정**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| <p>$ tar xvzf WRFV3.9.1.1.TAR.gz</p><p>$ cd WRFV3</p><p>$ ./configure </p><p> <mark style="color:orange;"> </mark><em><mark style="color:orange;">- - - - - 아래</mark><mark style="color:orange;"> </mark><mark style="color:orange;"><strong>[configure 과정 진행 내용]</strong></mark><mark style="color:orange;"> </mark><mark style="color:orange;">참고</mark></em></p><p>$ vi configure.wrf</p><p> <em> <mark style="color:orange;">- - - - - 아래</mark><mark style="color:orange;"> </mark><mark style="color:orange;"><strong>[configure.wrf 파일 수정 내용]</strong></mark><mark style="color:orange;"> </mark><mark style="color:orange;">참고</mark></em></p><p>$ ./compile em_real</p> |

※ WRFV3.9.1.1 버전의 경우 "compile em\_real" "-j 2" 옵션이 기본으로 사용되어 "compile -j 2 em\_real" 으로 빌드 되고, **CentOS 7.3 버전에서 빌드 시 컴파일 오류가 1회 발생함. 이 경우 "compile em\_real" 과정을 한번더 진행.**



_**\[configure 과정 진행 내용]**_

| <p>$ ./configure </p><p>checking for perl5... no</p><p>checking for perl... found /usr/bin/perl (perl)</p><p>Will use NETCDF in dir: /apps/compiler/intel/18.0.3/applib1/mic-knl/netcdf/4.6.1</p><p>Will use HDF5 in dir: /apps/compiler/intel/18.0.3/applib1/mic-knl/hdf5/1.10.2</p><p>PHDF5 not set in environment. Will configure WRF for use without.</p><p>Will use 'time' to report timing information</p><p><br></p><p>If you REALLY want Grib2 output from WRF, modify the arch/Config_new.pl script.</p><p>Right now you are not getting the Jasper lib, from the environment, compiled into WRF.</p><p></p><p>------------------------------------------------------------------------</p><p>Please select from among the following Linux x86_64 options:</p><p></p><p>  1. (serial)   2. (smpar)   3. (dmpar)   4. (dm+sm)   PGI (pgf90/gcc)</p><p>  5. (serial)   6. (smpar)   7. (dmpar)   8. (dm+sm)   PGI (pgf90/pgcc): SGI MPT</p><p>  9. (serial)  10. (smpar)  11. (dmpar)  12. (dm+sm)   PGI (pgf90/gcc): PGI accelerator</p><p> 13. (serial)  14. (smpar)  15. (dmpar)  16. (dm+sm)   INTEL (ifort/icc)</p><p>                                         17. (dm+sm)   INTEL (ifort/icc): Xeon Phi (MIC architecture)</p><p> 18. (serial)  19. (smpar)  20. (dmpar)  21. (dm+sm)   INTEL (ifort/icc): Xeon (SNB with AVX mods)</p><p> 22. (serial)  23. (smpar)  24. (dmpar)  25. (dm+sm)   INTEL (ifort/icc): SGI MPT</p><p> 26. (serial)  27. (smpar)  28. (dmpar)  29. (dm+sm)   INTEL (ifort/icc): IBM POE</p><p> 30. (serial)               31. (dmpar)                PATHSCALE (pathf90/pathcc)</p><p> 32. (serial)  33. (smpar)  34. (dmpar)  35. (dm+sm)   GNU (gfortran/gcc)</p><p> 36. (serial)  37. (smpar)  38. (dmpar)  39. (dm+sm)   IBM (xlf90_r/cc_r)</p><p> 40. (serial)  41. (smpar)  42. (dmpar)  43. (dm+sm)   PGI (ftn/gcc): Cray XC CLE</p><p> 44. (serial)  45. (smpar)  46. (dmpar)  47. (dm+sm)   CRAY CCE (ftn $(NOOMP)/cc): Cray XE and XC</p><p> 48. (serial)  49. (smpar)  50. (dmpar)  51. (dm+sm)   INTEL (ftn/icc): Cray XC</p><p> 52. (serial)  53. (smpar)  54. (dmpar)  55. (dm+sm)   PGI (pgf90/pgcc)</p><p> 56. (serial)  57. (smpar)  58. (dmpar)  59. (dm+sm)   PGI (pgf90/gcc): -f90=pgf90</p><p> 60. (serial)  61. (smpar)  62. (dmpar)  63. (dm+sm)   PGI (pgf90/pgcc): -f90=pgf90</p><p> 64. (serial)  65. (smpar)  66. (dmpar)  67. (dm+sm)   INTEL (ifort/icc): HSW/BDW</p><p> 68. (serial)  69. (smpar)  70. (dmpar)  71. (dm+sm)   INTEL (ifort/icc): KNL MIC</p><p> 72. (serial)  73. (smpar)  74. (dmpar)  75. (dm+sm)   FUJITSU (frtpx/fccpx): FX10/FX100 SPARC64 IXfx/Xlfx</p><p></p><p>Enter selection [1-75] : <mark style="color:blue;"><strong>70</strong></mark></p><p>------------------------------------------------------------------------</p><p>Compile for nesting? (1=basic, 2=preset moves, 3=vortex following) [default 1]: <mark style="color:blue;"><strong>1</strong></mark></p><p></p><p>Configuration successful! </p><p>------------------------------------------------------------------------</p><p>testing for MPI_Comm_f2c and MPI_Comm_c2f</p><p>   MPI_Comm_f2c and MPI_Comm_c2f are supported</p><p>testing for fseeko and fseeko64</p><p>fseeko64 is supported</p><p>------------------------------------------------------------------------</p><p></p><p># Settings for    Linux KNL x86_64 ppc64le i486 i586 i686  (dmpar)</p><p>#</p><p>DESCRIPTION     =       INTEL ($SFC/$SCC): KNL MIC</p><p>DMPARALLEL      =        1</p><p>OMPCPP          =       # -D_OPENMP</p><p>OMP             =       # -openmp -fpp -auto</p><p>OMPCC           =       # -openmp -fpp -auto</p><p>SFC             =       ifort</p><p>SCC             =       icc</p><p>CCOMP           =       icc</p><p>DM_FC           =       mpif90 -f90=$(SFC)</p><p>DM_CC           =       mpicc -cc=$(SCC) -DMPI2_SUPPORT</p><p>FC              =       time $(DM_FC)</p><p>CC              =       $(DM_CC) -DFSEEKO64_OK </p><p>LD              =       $(FC)</p><p>RWORDSIZE       =       $(NATIVE_RWORDSIZE)</p><p>PROMOTION       =       -real-size `expr 8 \* $(RWORDSIZE)` -i4</p><p>ARCH_LOCAL      =       -DNONSTANDARD_SYSTEM_FUNC -DWRF_USE_CLM</p><p>CFLAGS_LOCAL    =       -w -O3 -ip -fp-model fast=2 -no-prec-div -no-prec-sqrt -ftz -no-multibyte-chars -xMIC-AVX512</p><p>LDFLAGS_LOCAL   =       -ip -fp-model fast=2 -no-prec-div -no-prec-sqrt -ftz -align all -fno-alias -fno-common -xMIC-AVX512</p><p>CPLUSPLUSLIB    =       </p><p>ESMF_LDFLAG     =       $(CPLUSPLUSLIB)</p><p>FCOPTIM         =       -O3</p><p>FCREDUCEDOPT =       $(FCOPTIM)</p><p>FCNOOPT =       -O0 -fno-inline -no-ip</p><p>FCDEBUG         =       # -g $(FCNOOPT) -traceback # -fpe0 -check noarg_temp_created,bounds,format,output_conversion,pointers,uninit -ftrapuv -unroll0 -u</p><p>FORMAT_FIXED    =       -FI</p><p>FORMAT_FREE     =       -FR</p><p>FCSUFFIX        =</p><p>BYTESWAPIO      =       -convert big_endian</p><p>RECORDLENGTH    =       -assume byterecl</p><p>FCBASEOPTS_NO_G =       -ip -fp-model precise -w -ftz -align all -fno-alias $(FORMAT_FREE) $(BYTESWAPIO) -fp-model fast=2 -no-heap-arrays -no-prec-div -no-prec-sqrt -fno-common -xMIC-AVX512</p><p>FCBASEOPTS      =       $(FCBASEOPTS_NO_G) $(FCDEBUG)</p><p>MODULE_SRCH_FLAG =     </p><p>TRADFLAG        =      -traditional-cpp</p><p>CPP             =      /lib/cpp -P -nostdinc</p><p>AR              =      ar</p><p>ARFLAGS         =      ru</p><p>M4              =      m4</p><p>RANLIB          =      ranlib</p><p>RLFLAGS =</p><p>CC_TOOLS        =      $(SCC) </p><p></p><p>#insert new stanza here</p><p></p><p>###########################################################</p><p>######################</p><p># POSTAMBLE</p><p></p><p>FGREP = fgrep -iq</p><p></p><p>ARCHFLAGS       =    $(COREDEFS) -DIWORDSIZE=$(IWORDSIZE) -DDWORDSIZE=$(DWORDSIZE) -DRWORDSIZE=$(RWORDSIZE) -DLWORDSIZE=$(LWORDSIZE) \</p><p>                     $(ARCH_LOCAL) \</p><p>                     $(DA_ARCHFLAGS) \</p><p>                      -DDM_PARALLEL \</p><p>                       \</p><p>                      -DNETCDF \</p><p>                       \</p><p>                       \</p><p>                       \</p><p>                       \</p><p>                       \</p><p>                      -DHDF5 \</p><p>                       \</p><p>                       \</p><p>                       \</p><p>                       \</p><p>                      -DUSE_ALLOCATABLES \</p><p>                      -DGRIB1 \</p><p>                      -DINTIO \</p><p>                      -DKEEP_INT_AROUND \</p><p>                      -DLIMIT_ARGS \</p><p>                      -DCONFIG_BUF_LEN=$(CONFIG_BUF_LEN) \</p><p>                      -DMAX_DOMAINS_F=$(MAX_DOMAINS) \</p><p>                      -DMAX_HISTORY=$(MAX_HISTORY) \</p><p>      -DNMM_NEST=$(WRF_NMM_NEST)</p><p>CFLAGS          =    $(CFLAGS_LOCAL) -DDM_PARALLEL  \</p><p>                      -DMAX_HISTORY=$(MAX_HISTORY) -DNMM_CORE=$(WRF_NMM_CORE)</p><p>FCFLAGS         =    $(FCOPTIM) $(FCBASEOPTS)</p><p>ESMF_LIB_FLAGS  =    </p><p># ESMF 5 -- these are defined in esmf.mk, included above</p><p> ESMF_IO_LIB     =    -L$(WRF_SRC_ROOT_DIR)/external/esmf_time_f90 -lesmf_time</p><p>ESMF_IO_LIB_EXT =    -L$(WRF_SRC_ROOT_DIR)/external/esmf_time_f90 -lesmf_time</p><p>INCLUDE_MODULES =    $(MODULE_SRCH_FLAG) \</p><p>                     $(ESMF_MOD_INC) $(ESMF_LIB_FLAGS) \</p><p>                      -I$(WRF_SRC_ROOT_DIR)/main \</p><p>                      -I$(WRF_SRC_ROOT_DIR)/external/io_netcdf \</p><p>                      -I$(WRF_SRC_ROOT_DIR)/external/io_int \</p><p>                      -I$(WRF_SRC_ROOT_DIR)/frame \</p><p>                      -I$(WRF_SRC_ROOT_DIR)/share \</p><p>                      -I$(WRF_SRC_ROOT_DIR)/phys \</p><p>                      -I$(WRF_SRC_ROOT_DIR)/chem -I$(WRF_SRC_ROOT_DIR)/inc \</p><p>                      -I$(NETCDFPATH)/include \</p><p>                      </p><p>REGISTRY        =    Registry</p><p>CC_TOOLS_CFLAGS = -DNMM_CORE=$(WRF_NMM_CORE)</p><p></p><p> LIB_BUNDLED     = \</p><p>                      $(WRF_SRC_ROOT_DIR)/external/fftpack/fftpack5/libfftpack.a \</p><p>                      $(WRF_SRC_ROOT_DIR)/external/io_grib1/libio_grib1.a \</p><p>                      $(WRF_SRC_ROOT_DIR)/external/io_grib_share/libio_grib_share.a \</p><p>                      $(WRF_SRC_ROOT_DIR)/external/io_int/libwrfio_int.a \</p><p>                      $(ESMF_IO_LIB) \</p><p>                      $(WRF_SRC_ROOT_DIR)/external/RSL_LITE/librsl_lite.a \</p><p>                      $(WRF_SRC_ROOT_DIR)/frame/module_internal_header_util.o \</p><p>                      $(WRF_SRC_ROOT_DIR)/frame/pack_utils.o </p><p></p><p> LIB_EXTERNAL    = \</p><p>                      -L$(WRF_SRC_ROOT_DIR)/external/io_netcdf -lwrfio_nf -L/apps/compiler/intel/18.0.3/applib1/mic-knl/netcdf/4.6.1/lib -lnetcdff -lnetcdf     -L/apps/compiler/intel/18.0.3/applib1/mic-knl/hdf5/1.10.2/lib -lhdf5_fortran -lhdf5 -lm -lz</p><p><br></p><p>LIB             =    $(LIB_BUNDLED) $(LIB_EXTERNAL) $(LIB_LOCAL) $(LIB_WRF_HYDRO)</p><p>LDFLAGS         =    $(OMP) $(FCFLAGS) $(LDFLAGS_LOCAL) </p><p>ENVCOMPDEFS     =    </p><p>WRF_CHEM = 0 </p><p>CPPFLAGS        =    $(ARCHFLAGS) $(ENVCOMPDEFS) -I$(LIBINCLUDE) $(TRADFLAG) </p><p>NETCDFPATH      =    /apps/compiler/intel/18.0.3/applib1/mic-knl/netcdf/4.6.1</p><p>HDF5PATH        =    /apps/compiler/intel/18.0.3/applib1/mic-knl/hdf5/1.10.2</p><p>WRFPLUSPATH     =    </p><p>RTTOVPATH       =    </p><p>PNETCDFPATH     =    </p><p></p><p>bundled:  io_only </p><p>external: io_only $(WRF_SRC_ROOT_DIR)/external/RSL_LITE/librsl_lite.a gen_comms_rsllite module_dm_rsllite $(ESMF_TARGET)</p><p>io_only:  esmf_time wrfio_nf   \</p><p>  wrf_ioapi_includes wrfio_grib_share wrfio_grib1 wrfio_int fftpack</p><p><br></p><p>######################</p><p>------------------------------------------------------------------------</p><p>Settings listed above are written to configure.wrf.</p><p>If you wish to change settings, please edit that file.</p><p>If you wish to change the default options, edit the file:</p><p>     arch/configure_new.defaults</p><p>NetCDF users note:</p><p> This installation of NetCDF supports large file support.  To DISABLE large file</p><p> support in NetCDF, set the environment variable WRFIO_NCD_NO_LARGE_FILE_SUPPORT</p><p> to 1 and run configure again. Set to any other value to avoid this message.</p><p>  <br></p><p>Testing for NetCDF, C and Fortran compiler</p><p></p><p>This installation of NetCDF is 64-bit</p><p>                 C compiler is 64-bit</p><p>           Fortran compiler is 64-bit</p><p>              It will build in 64-bit</p> |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |



_**\[configure.wrf 파일 수정 내용]**_

| <p>DM_FC           =       <mark style="color:blue;"><strong>mpiifort</strong></mark> -f90=$(SFC)</p><p>DM_CC           =       <mark style="color:blue;"><strong>mpiicc</strong></mark> -cc=$(SCC) -DMPI2_SUPPORT</p><p>CFLAGS_LOCAL    =       -w -O3 -ip -fp-model fast=2 -no-prec-div -no-prec-sqrt -ftz -no-multibyte-chars <mark style="color:blue;"><strong>-xCOMMON-AVX512</strong></mark></p><p>LDFLAGS_LOCAL   =       -ip -fp-model fast=2 -no-prec-div -no-prec-sqrt -ftz -align all -fno-alias -fno-common <mark style="color:blue;"><strong>-xCOMMON-AVX512</strong></mark></p><p>FCBASEOPTS_NO_G =       -ip -fp-model precise -w -ftz -align all -fno-alias $(FORMAT_FREE) $(BYTESWAPIO) -fp-model fast=2 -no-heap-arrays -no-prec-div -no-prec-sqrt -fno-common <mark style="color:blue;"><strong>-xCOMMON-AVX512</strong></mark></p> |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |

※ 설치를 진행한 CPU 타입과 계산을 수행할 CPU 타입이 다른 경우는 꼭 configure.wrf 파일의 "<mark style="color:red;">**-xHost**</mark><mark style="color:red;">"</mark> <mark style="color:red;"></mark><mark style="color:red;">**옵션을 삭제**</mark>하고 빌드를 진행한다.    (예 : login 노드(SKL CPU 타입)에서 설치를 진행 하고 KNL 계산노드 에서 수행하는 경우)

※ 누리온 시스템 설치 예제는 SKL/KNL 계산노드에서 공통적으로 사용을 위해 "-xCOMMON-AVX512" 로 작성

&#x20;\- SKL(skylake) 노드 전용 : -xCORE-AVX512\
&#x20;\- KNL(Intel Xeon Phi Knights Landing) 전용 : -xMIC-AVX512\
&#x20;\- SKL 과 KNL 공통 적용 : -xCOMMON-AVX512\
&#x20;\- 참고 :  https://software.intel.com/en-us/articles/compiling-for-the-intel-xeon-phi-processor-and-the-intel-avx-512-isa



**4. WPS 설치 과정**

&#x20;설치 과정 소개는 tar 를 이용한 압축 해제 방법과 설정 방법등 진행 절차를 위주로 설명하고, 소스 파일 다운로드 등은 생략한다. &#x20;

|  **설치 과정**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| <p>$ tar xvzf WPSV3.9.1.TAR.gz</p><p>$ cd WPS</p><p>$ ./configure </p><p> <mark style="color:orange;"> </mark><em><mark style="color:orange;">- - - - - 아래</mark><mark style="color:orange;"> </mark><mark style="color:orange;"><strong>[configure 과정 진행 내용]</strong></mark><mark style="color:orange;"> </mark><mark style="color:orange;">참고</mark></em></p><p>$ vi configure.wps</p><p> <mark style="color:orange;"> </mark><em><mark style="color:orange;">- - - - - 아래</mark><mark style="color:orange;"> </mark><mark style="color:orange;"><strong>[configure.wps 파일 수정 내용]</strong></mark><mark style="color:orange;"> </mark><mark style="color:orange;">참고</mark></em></p><p>$ ./compile </p> |



_**\[configure 과정 진행 내용]**_

| <p>$ ./configure </p><p>Will use NETCDF in dir: /apps/compiler/intel/18.0.3/applib1/mic-knl/netcdf/4.6.1</p><p>Found Jasper environment variables for GRIB2 support...</p><p>  $JASPERLIB = /apps/common/jasper/1.900.29/lib</p><p>  $JASPERINC = /apps/common/jasper/1.900.29/include</p><p>------------------------------------------------------------------------</p><p>Please select from among the following supported platforms.</p><p></p><p>   1.  Linux x86_64, gfortran    (serial)</p><p>   2.  Linux x86_64, gfortran    (serial_NO_GRIB2)</p><p>   3.  Linux x86_64, gfortran    (dmpar)</p><p>   4.  Linux x86_64, gfortran    (dmpar_NO_GRIB2)</p><p>   5.  Linux x86_64, PGI compiler   (serial)</p><p>   6.  Linux x86_64, PGI compiler   (serial_NO_GRIB2)</p><p>   7.  Linux x86_64, PGI compiler   (dmpar)</p><p>   8.  Linux x86_64, PGI compiler   (dmpar_NO_GRIB2)</p><p>   9.  Linux x86_64, PGI compiler, SGI MPT   (serial)</p><p>  10.  Linux x86_64, PGI compiler, SGI MPT   (serial_NO_GRIB2)</p><p>  11.  Linux x86_64, PGI compiler, SGI MPT   (dmpar)</p><p>  12.  Linux x86_64, PGI compiler, SGI MPT   (dmpar_NO_GRIB2)</p><p>  13.  Linux x86_64, IA64 and Opteron    (serial)</p><p>  14.  Linux x86_64, IA64 and Opteron    (serial_NO_GRIB2)</p><p>  15.  Linux x86_64, IA64 and Opteron    (dmpar)</p><p>  16.  Linux x86_64, IA64 and Opteron    (dmpar_NO_GRIB2)</p><p>  17.  Linux x86_64, Intel compiler    (serial)</p><p>  18.  Linux x86_64, Intel compiler    (serial_NO_GRIB2)</p><p>  <mark style="color:blue;">  <strong>19.  Linux x86_64, Intel compiler    (dmpar)</strong></mark></p><p>  20.  Linux x86_64, Intel compiler    (dmpar_NO_GRIB2)</p><p>  21.  Linux x86_64, Intel compiler, SGI MPT    (serial)</p><p>  22.  Linux x86_64, Intel compiler, SGI MPT    (serial_NO_GRIB2)</p><p>  23.  Linux x86_64, Intel compiler, SGI MPT    (dmpar)</p><p>  24.  Linux x86_64, Intel compiler, SGI MPT    (dmpar_NO_GRIB2)</p><p>  25.  Linux x86_64, Intel compiler, IBM POE    (serial)</p><p>  26.  Linux x86_64, Intel compiler, IBM POE    (serial_NO_GRIB2)</p><p>  27.  Linux x86_64, Intel compiler, IBM POE    (dmpar)</p><p>  28.  Linux x86_64, Intel compiler, IBM POE    (dmpar_NO_GRIB2)</p><p>  29.  Linux x86_64 g95 compiler     (serial)</p><p>  30.  Linux x86_64 g95 compiler     (serial_NO_GRIB2)</p><p>  31.  Linux x86_64 g95 compiler     (dmpar)</p><p>  32.  Linux x86_64 g95 compiler     (dmpar_NO_GRIB2)</p><p>  33.  Cray XE/XC CLE/Linux x86_64, Cray compiler   (serial)</p><p>  34.  Cray XE/XC CLE/Linux x86_64, Cray compiler   (serial_NO_GRIB2)</p><p>  35.  Cray XE/XC CLE/Linux x86_64, Cray compiler   (dmpar)</p><p>  36.  Cray XE/XC CLE/Linux x86_64, Cray compiler   (dmpar_NO_GRIB2)</p><p>  37.  Cray XC CLE/Linux x86_64, Intel compiler   (serial)</p><p>  38.  Cray XC CLE/Linux x86_64, Intel compiler   (serial_NO_GRIB2)</p><p>  39.  Cray XC CLE/Linux x86_64, Intel compiler   (dmpar)</p><p>  40.  Cray XC CLE/Linux x86_64, Intel compiler   (dmpar_NO_GRIB2)</p><p></p><p>Enter selection [1-40] : <mark style="color:blue;"><strong>19</strong></mark></p><p>------------------------------------------------------------------------</p><p>Configuration successful. To build the WPS, type: compile</p><p>------------------------------------------------------------------------</p><p></p><p>Testing for NetCDF, C and Fortran compiler</p><p></p><p>This installation NetCDF is 64-bit</p><p>C compiler is 64-bit</p><p>Fortran compiler is 64-bit</p><p><br></p> |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |



_**\[configure.wps 파일 수정 내용]**_

| <p>DM_FC               = <mark style="color:blue;"><strong>mpiifort</strong></mark> -f90=ifort</p><p>DM_CC               = <mark style="color:blue;"><strong>mpiicc</strong></mark> -cc=icc</p><p>FFLAGS              = -FR -convert big_endian <mark style="color:blue;"><strong>-O2 -xCOMMON-AVX512</strong></mark></p><p>F77FLAGS            = -FI -convert big_endian <mark style="color:blue;"><strong>-O2 -xCOMMON-AVX512</strong></mark></p><p>CFLAGS              = -w <mark style="color:blue;"><strong>-O2 -xCOMMON-AVX512</strong></mark></p> |
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |



**5. 기타**

&#x20;만약 WPS를 SKL CPU 노드(login노드, norm\_skl큐)에서 실행하는 경우에는 \
&#x20;craype-mic-knl 모듈 대신 craype-x86-skylake 모듈을 사용 하도록 환경설정을 해야 한다.



\[ 환경 설정 ]

| <p> $ module load <mark style="color:blue;">craype-x86-skylake</mark> intel/18.0.3 impi/18.0.3</p><p> $ module load hdf4/4.2.13 hdf5/1.10.2 netcdf/4.6.1 ncl/6.5.0</p><p> $ export JASPERLIB=/apps/common/jasper/1.900.29/lib</p><p> $ export JASPERINC=/apps/common/jasper/1.900.29/include</p> |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |

\
